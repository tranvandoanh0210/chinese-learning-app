<div class="grammar-exercise">
  @for (exercise of getGrammarExercises(); track $index) {
  <div class="grammar-lesson">
    <!-- Lesson Header -->
    <div class="lesson-header" [class.completed]="isExerciseCompleted(exercise)">
      <h2 class="lesson-title">{{ exercise.question }}</h2>
      @if (exercise.answer) {
      <div class="lesson-subtitle">
        {{ exercise.answer }}
      </div>
      }
      <div class="status-icon">
        @if (isExerciseCompleted(exercise)) {
        <span class="checkmark">‚úì</span>
        }
      </div>
    </div>

    <!-- Main Content -->
    <div class="lesson-content">
      <!-- Main Explanation -->
      @if (exercise.content) {
      <div class="content-block main-explanation">
        <div class="content-text" [innerHTML]="formatContent(exercise.content)"></div>
      </div>
      }

      <!-- Examples -->
      @if (exercise.examples && exercise.examples.length) {
      <div class="content-block examples-block">
        <h3 class="block-title">
          <span class="icon">üìö</span>
          V√≠ d·ª• minh h·ªça
        </h3>
        <div class="examples-list">
          @for (example of exercise.examples; track $index) {
          <div class="example-item">
            <div class="example-chinese">{{ getChineseExample(example) }}</div>
            <div class="example-pinyin">{{ getPinyinExample(example) }}</div>
            <div class="example-vietnamese">{{ getVietnameseExample(example) }}</div>
          </div>
          }
        </div>
      </div>
      }

      <!-- Final Explanation -->
      @if (exercise.explanation) {
      <div class="content-block explanation-block">
        <h3 class="block-title">
          <span class="icon">üéØ</span>
          Ghi nh·ªõ
        </h3>
        <div class="explanation-content">
          {{ exercise.explanation }}
        </div>
      </div>
      }
    </div>
    @if(!isExerciseCompleted(exercise)){
    <div class="lesson-footer">
      <button class="btn-complete" (click)="markAsCompleted(exercise)">
        <span>ƒê√°nh d·∫•u ƒë√£ h·ªçc</span>
      </button>
    </div>
    }
  </div>
  }
</div>
