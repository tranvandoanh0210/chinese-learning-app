<div class="writing-exercise">
  <div *ngFor="let exercise of getWritingExercises(); let i = index" class="exercise-item">
    <div class="writing-card">
      <!-- Character Info -->
      <div class="character-info">
        <div class="main-character">{{ exercise.question }}</div>
        <div class="character-details">
          <div class="pinyin">{{ exercise.pinyin }}</div>
          <div class="meaning">{{ exercise.answer }}</div>
        </div>
      </div>

      <!-- Stroke Order Guide - S·ª≠ d·ª•ng SVG thay v√¨ GIF -->
      <!-- <div class="stroke-guide">
        <h4>H∆∞·ªõng d·∫´n th·ª© t·ª± vi·∫øt c√°c n√©t:</h4>
      </div> -->

      <!-- Practice Canvas -->
      <div class="practice-section">
        <div class="canvas-container">
          <canvas
            #writingCanvas
            (mousedown)="onMouseDown($event, i)"
            (mousemove)="onMouseMove($event, i)"
            (mouseup)="onMouseUp(i)"
            (mouseleave)="onMouseUp(i)"
            (touchstart)="onTouchStart($event, i)"
            (touchmove)="onTouchMove($event, i)"
            (touchend)="onTouchEnd(i)"
            class="writing-canvas"
          >
          </canvas>

          <!-- Character Template (background) -->
          <div class="character-template" aria-hidden="true">{{ exercise.question }}</div>
        </div>

        <!-- Drawing Controls -->
        <div class="drawing-controls">
          <button class="btn btn-outline" (click)="undoStroke(i)" [disabled]="!canUndo(i)">
            ‚Ü©Ô∏è Undo
          </button>
          <button class="btn btn-outline" (click)="redoStroke(i)" [disabled]="!canRedo(i)">
            ‚Ü™Ô∏è Redo
          </button>
          <button class="btn btn-secondary" (click)="clearCanvas(i)">üóëÔ∏è X√≥a h·∫øt</button>
          <!-- <button class="btn btn-success" (click)="completeWriting(exercise)">‚úÖ Ho√†n th√†nh</button> -->
        </div>
      </div>
    </div>
  </div>
</div>
